<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-020D2NVH9F"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-020D2NVH9F');
  </script>
  <meta charset="UTF-8">
  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="apple-touch-icon" href="favicon.png">
  <meta property="og:title" content="AIB CBB Blog">
  <meta property="og:description" content="College basketball rankings, bracketology, and analytics powered by AI Bracketology">
  <meta property="og:image" content="https://ai-bracketology.github.io/cbb-rankings/docs/new_header.png">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AIB CBB Blog</title>
  <script>
    (function(){
      var t = localStorage.getItem("cbb_theme");
      if (t === "light") document.documentElement.setAttribute("data-theme","light");
    })();
    window.addEventListener("pageshow", function(e) {
      if (e.persisted) window.location.reload();
    });
  </script>
  <style>
    :root {
      --bg:        #0d1117;
      --surface:   #161b22;
      --border:    #30363d;
      --text:      #c9d1d9;
      --text-dim:  #8b949e;
      --accent:    #58a6ff;
      --accent2:   #79c0ff;
    }
    html[data-theme="light"] {
      --bg:        #ffffff;
      --surface:   #f6f8fa;
      --border:    #d0d7de;
      --text:      #1f2328;
      --text-dim:  #656d76;
      --accent:    #0969da;
      --accent2:   #0550ae;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      padding: 0;
    }
    .blog-header {
      background: var(--surface);
      border-bottom: 1px solid var(--border);
      padding: 18px 24px;
      display: flex;
      align-items: center;
      justify-content: flex-start;
    }
    .back-link {
      color: var(--accent);
      background: none;
      border: none;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      text-decoration: underline;
      margin-right: 24px;
    }
    .blog-title {
      font-size: 1.3rem;
      font-weight: 600;
      margin: 0;
    }
    /* theme toggle */
    .theme-toggle {
      background: var(--surface);
      border: 1px solid var(--border);
      color: var(--text);
      font-size: 1.1rem;
      padding: 5px 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: border-color .15s;
      line-height: 1;
      margin-left: auto;
    }
    .theme-toggle:hover { border-color: var(--accent); }
    .blog-content {
      max-width: 1100px;
      margin: 32px auto;
      padding: 0 32px;
    }
    @media (max-width: 700px) {
      .blog-header {
        flex-direction: column;
        align-items: flex-start;
        padding: 14px 16px;
        gap: 6px;
      }
      .back-link { margin-right: 0; font-size: .9rem; }
      .blog-title { font-size: 1.1rem; }
      .blog-content {
        max-width: 100vw;
        padding: 0 4vw;
      }
      .blog-post {
        padding: 12px 2vw;
      }
      .blog-post img {
        max-width: 100%;
        height: auto;
        margin-left: auto;
        margin-right: auto;
        display: block;
      }
      .theme-toggle { margin-left: 0; }
    }
    .blog-post {
      margin-bottom: 2.5em;
      background: var(--surface);
      border-radius: 8px;
      padding: 24px;
      border: 1px solid var(--border);
    }
    .blog-post ul, .blog-post ol {
      margin-left: 2em !important;
      padding-left: 0 !important;
      margin-bottom: 1em;
      list-style-position: outside;
    }
    .blog-post ul.dash-list {
  margin-left: 5em !important;
  margin-top: 0.6em;
    }
    .blog-post p + ul.dash-list {
  margin-top: 0 !important;
    }
    .blog-post li {
      margin-bottom: 0.3em;
    }
    .blog-post h2 {
      margin-top: 0;
      color: var(--accent);
    }
    .blog-meta {
      color: var(--text-dim);
      font-size: .95em;
      margin-bottom: .5em;
    }
    .blog-post a {
      color: var(--accent2);
      text-decoration: underline;
      transition: color .15s;
    }
    .blog-post a:hover {
      color: var(--accent);
    }
  </style>
</head>
<body>
  <div class="blog-header">
    <button class="back-link" onclick="window.location.href='index.html'">&larr; Go Back to Rankings</button>
    <span class="blog-title">üèÄ Blog</span>
    <button class="theme-toggle" id="themeToggle" title="Toggle light/dark mode">üåô</button>
  </div>
  <div class="blog-content" id="blogContent">
    <div id="postsLoading" style="color:var(--text-dim);">Loading posts...</div>
  </div>
  <script>
    /* ---- theme toggle ---- */
    (function initThemeToggle() {
      const btn = document.getElementById("themeToggle");
      const isLight = document.documentElement.getAttribute("data-theme") === "light";
      btn.textContent = isLight ? "‚òÄÔ∏è" : "üåô";
      btn.addEventListener("click", () => {
        const nowLight = document.documentElement.getAttribute("data-theme") === "light";
        if (nowLight) {
          document.documentElement.removeAttribute("data-theme");
          localStorage.setItem("cbb_theme", "dark");
          btn.textContent = "üåô";
        } else {
          document.documentElement.setAttribute("data-theme", "light");
          localStorage.setItem("cbb_theme", "light");
          btn.textContent = "‚òÄÔ∏è";
        }
      });
    })();

    // List of blog post files (could be automated with a manifest or serverless function)
    const postFiles = [
      'posts/2026-02-26-compare.md',
      'posts/2026-02-20-welcome.md'
      // Add more posts here as you create them
    ];

    function parseFrontmatter(md) {
      const fm = md.match(/^---([\s\S]*?)---/);
      let title = '', date = '', body = md;
      if (fm) {
        const lines = fm[1].split(/\r?\n/);
        for (const l of lines) {
          if (l.startsWith('title:')) title = l.replace('title:', '').trim();
          if (l.startsWith('date:')) date = l.replace('date:', '').trim();
        }
        body = md.slice(fm[0].length).trim();
      }
      return { title, date, body };
    }

    function markdownToHtml(md) {
      // Headings, bold, italics, code, links
      let html = md
        .replace(/^### (.*)$/gm, '<h4>$1</h4>')
        .replace(/^## (.*)$/gm, '<h3>$1</h3>')
        .replace(/^# (.*)$/gm, '<h2>$1</h2>')
        .replace(/!\[(.*?)\]\((.*?)\)/g, '<img src="$2" alt="$1" style="max-width:100%;display:block;margin:1.2em auto;">')
        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
        .replace(/\*(.*?)\*/g, '<em>$1</em>')
        .replace(/`([^`]+)`/g, '<code>$1</code>')
        .replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank">$1</a>');
      // Bulleted lists: wrap consecutive - lines in <ul class="dash-list"> (even if not separated by blank lines)
      html = html.replace(/(^|\n)(- .*(?:\n- .*)*)/g, function(_, p1, block) {
        // Only match if every line in block starts with -
        const lines = block.split(/\n/);
        if (lines.every(line => /^- /.test(line))) {
          const items = lines.map(line => line.replace(/^- (.*)/, '<li>$1</li>')).join('');
          return p1 + '<ul class="dash-list">' + items + '</ul>';
        } else {
          return p1 + block;
        }
      });
      // Bulleted lists: wrap consecutive * lines in <ul>
      html = html.replace(/(^|\n)((?:\* .*(?:\n|$))+)/g, function(_, p1, block) {
        const items = block.trim().split(/\n/).map(line => line.replace(/^\* (.*)/, '<li>$1</li>')).join('');
        return p1 + '<ul>' + items + '</ul>';
      });
      // Numbered lists: wrap consecutive 1. 2. 3. lines in <ol>
      html = html.replace(/(^|\n)((?:\d+\. .*(?:\n|$))+)/g, function(_, p1, block) {
        const items = block.trim().split(/\n/).map(line => line.replace(/^\d+\. (.*)/, '<li>$1</li>')).join('');
        return p1 + '<ol>' + items + '</ol>';
      });
      // Paragraphs: wrap non-block lines in <p>
      html = html.replace(/(^|\n)(?!<h\d|<ul>|<ol>|<li>|<\/ul>|<\/ol>|<\/li>)([^<\n][^\n]*)/g, function(_, p1, p2) {
        if (!p2 || /^\s*$/.test(p2)) return _;
        return p1 + '<p>' + p2 + '</p>';
      });
      return html;
    }

    async function loadBlogPosts() {
      const posts = [];
      for (const file of postFiles) {
        try {
          const resp = await fetch(file);
          if (!resp.ok) continue;
          const text = await resp.text();
          const { title, date, body } = parseFrontmatter(text);
          posts.push({ title, date, body });
        } catch {}
      }
      // Sort posts by date descending
      posts.sort((a, b) => (b.date || '').localeCompare(a.date || ''));
      const contentDiv = document.getElementById('blogContent');
      document.getElementById('postsLoading').remove();
      if (!posts.length) {
        contentDiv.innerHTML += '<div style="color:var(--text-dim);">No posts found.</div>';
        return;
      }
      for (const post of posts) {
        const html = `
          <div class="blog-post">
            <h2>${post.title || '(Untitled Post)'}</h2>
            <div class="blog-meta">${post.date ? 'Posted ' + post.date : ''}</div>
            <div>${markdownToHtml(post.body)}</div>
          </div>
        `;
        contentDiv.innerHTML += html;
      }
    }
    loadBlogPosts();
  </script>
</body>
</html>
